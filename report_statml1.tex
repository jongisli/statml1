\documentclass[a4paper,10pt]{article}
\usepackage{a4wide}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}

\usepackage{xfrac} 				% gives \sfrac
\usepackage{amsmath}
\usepackage{enumerate} 		% allows you to change counters
\usepackage{verbatim}
\usepackage{comment}				% gives comment environment
\usepackage{hyperref}
\usepackage{amssymb}				% gives f.x. \mathbb{R}

% graphics packages
\usepackage{graphicx}
\usepackage{caption} 	
\usepackage{subcaption}
\usepackage{float}

\title{
	Assignment 1 - Foundations of Statistical Machine Learning	\\
	Statistical Methods for Machine Learning
  }
\author{
	Guðmundur Páll Kjartansson \\
	Jón Gísli Egilsson
}

% Uncomment to set paragraph indentation to 0 points, and skips a line
% after an ended paragraph.
\setlength{\parindent}{0pt}
\setlength{\parskip}{\baselineskip}

\begin{document}
\maketitle

\section*{Probability and Parameter Estimation}

\subsection*{Question 1.1}

In figure $1$ we display different 1-dimentional Gaussian distribution functions.
\begin{figure}[H]
	\centering
  	\includegraphics[width=0.5\textwidth]{gaussian.png}
  	\caption{Gaussian distribution functions}
\end{figure}

\subsection*{Question 1.2}

We made a function \verb=data(N)= that generates a data set consisting of $N=100$ 2-dimensional samples with the parameters
$$\mu = (1, 1)$$
and
$$\bf{\Sigma} = \begin{pmatrix} 0.3 & 0.2 \\ 0.2 & 0.2 \end{pmatrix}.$$


\subsection*{Question 1.3}

Here we estimate the maximum likelihood sample mean and sample covariance from a dataset generated by \verb=data(100)=. Our estimated parameters are
$${\mu_{ML}} = (0.90, 0.94)$$
and
$$\bf{\Sigma}_{ML} = \begin{pmatrix} 0.33 & 0.23 \\ 0.23 & 0.24 \end{pmatrix}.$$
In figure $2$ we can see a scatterplot of the data and also $\bf{\mu}$ and $\bf{\mu}_{ML}$.
\begin{figure}[H]
	\centering
  	\includegraphics[width=0.5\textwidth]{scatter.png}
  	\caption{Scatterplot of data generated in Question $1.2$}
\end{figure}
To quantify how much the sample mean deviates from the correct mean we calculate the Euclidian distance and get
$$	||\mu - \mu_{ML}|| = 0.12.$$
So we see a little deviation 	from the mean as is expected since we only took $N=100$ samples from the distribution. To get a sample mean that is closer to the true mean we have to take increase the sample size. As $N \to \infty$ we will have $\mu \to \mu_{ML}$.

\section{The Gaussian distribution and its conditional and marginal distributions}

\subsection{Question 1.4}

TODO

\section{Non-parametric estimation - histograms}

\subsection*{Question 1.5}

In figures $3$ and $4$ we can see 	histogram based probability density estimate of the marginal distributions $p(x_1)$ and $p(x_2)$ respectively. In each subfigure we change the number of bins used to represent the density.

\begin{figure}[H]
	\centering
	\begin{subfigure}{0.3\textwidth}
  		\centering
  		\includegraphics[width=\textwidth]{histogram1bins5.png}
  		\caption{$p(x_1)$ with $5$ bins}
  \end{subfigure}
  \begin{subfigure}{0.3\textwidth}
  		\centering
  		\includegraphics[width=\textwidth]{histogram1bins10.png}
  		\caption{$p(x_1)$ with $10$ bins}
  \end{subfigure}
  \begin{subfigure}{0.3\textwidth}
  		\centering
  		\includegraphics[width=\textwidth]{histogram1bins20.png}
  		\caption{$p(x_1)$ with $20$ bins}
  \end{subfigure}
  	\caption{Probability density estimate of $p(x_1)$}
\end{figure}

\begin{figure}[H]
	\centering
	\begin{subfigure}{0.3\textwidth}
  		\centering
  		\includegraphics[width=\textwidth]{histogram2bins5.png}
  		\caption{$p(x_2)$ with $5$ bins}
  \end{subfigure}
  \begin{subfigure}{0.3\textwidth}
  		\centering
  		\includegraphics[width=\textwidth]{histogram2bins10.png}
  		\caption{$p(x_2)$ with $10$ bins}
  \end{subfigure}
  \begin{subfigure}{0.3\textwidth}
  		\centering
  		\includegraphics[width=\textwidth]{histogram2bins20.png}
  		\caption{$p(x_2)$ with $20$ bins}
  \end{subfigure}
  	\caption{Probability density estimate of $p(x_2)$}
\end{figure}

As we see when we increase the number of bins we get a more detailed estimate. If however we make the number of bins to large we will get some unwanted detail which could possibly lead one to think that the function we are estimating has some features which it really doesn't. For example in figure $4(b)$ and $4(c)$ one might think that the function from which the sample is taken from has two maximas which the Gaussian function obviously doesn't.

\subsection*{Question 1.6}

We can see the plot in figure $5$ of our histogram estimate of $p(x_1)$ together with the analytical solution given the mean $\mu = 1$ and $\sigma^2 = 0.3$. The analytical expression for the marginal distribution $p(x_1)$ is
$$\mathcal{N}(x|1, 0.3) = \frac{1}{\sqrt{2\pi 0.3}}\exp\left(-\frac{1}{2*0.3}(x-1)^2 \right).$$

\begin{figure}[H]
	\centering
  	\includegraphics[width=0.5\textwidth]{hist_and_analytical.png}
  	\caption{Histogram estimate and the analytical solution}
\end{figure}

\subsection*{Question 1.7}

Here we plot the 2-dimensional histogram estimates of $p(\bf{x})$ from Question $1.2$ for $N=100$, $1000$, and $10.000$ where we vary the number of bins between $10 \times 10$, $15 \times 15$ and $20 \times 20$. The results are shown in figures $6$, $7$ and $8$.

\begin{figure}[H]
	\centering
	\begin{subfigure}{0.4\textwidth}
  		\centering
  		\includegraphics[width=\textwidth]{histogram3d_10bins_100.png}
  		\caption{$10 \times 10$ bins}
  \end{subfigure}
  \begin{subfigure}{0.4\textwidth}
  		\centering
  		\includegraphics[width=\textwidth]{histogram3d_15bins_100.png}
  		\caption{$15 \times 15$ bins}
  \end{subfigure}
  \begin{subfigure}{0.4\textwidth}
  		\centering
  		\includegraphics[width=\textwidth]{histogram3d_20bins_100.png}
  		\caption{$20 \times 20$ bins}
  \end{subfigure}
  	\caption{Estimate of $p(\bf{x})$ where $N = 100$}
\end{figure}

\begin{figure}[H]
	\centering
	\begin{subfigure}{0.4\textwidth}
  		\centering
  		\includegraphics[width=\textwidth]{histogram3d_10bins_1000.png}
  		\caption{$10 \times 10$ bins}
  \end{subfigure}
  \begin{subfigure}{0.4\textwidth}
  		\centering
  		\includegraphics[width=\textwidth]{histogram3d_15bins_1000.png}
  		\caption{$15 \times 15$ bins}
  \end{subfigure}
  \begin{subfigure}{0.4\textwidth}
  		\centering
  		\includegraphics[width=\textwidth]{histogram3d_20bins_1000.png}
  		\caption{$20 \times 20$ bins}
  \end{subfigure}
  	\caption{Estimate of $p(\bf{x})$ where $N = 1000$}
\end{figure}

\begin{figure}[H]
	\centering
	\begin{subfigure}{0.4\textwidth}
  		\centering
  		\includegraphics[width=\textwidth]{histogram3d_10bins_10000.png}
  		\caption{$10 \times 10$ bins}
  \end{subfigure}
  \begin{subfigure}{0.4\textwidth}
  		\centering
  		\includegraphics[width=\textwidth]{histogram3d_15bins_10000.png}
  		\caption{$15 \times 15$ bins}
  \end{subfigure}
  \begin{subfigure}{0.4\textwidth}
  		\centering
  		\includegraphics[width=\textwidth]{histogram3d_20bins_10000.png}
  		\caption{$20 \times 20$ bins}
  \end{subfigure}
  	\caption{Estimate of $p(\bf{x})$ where $N = 10000$}
\end{figure}

The red part of the plots means high density value and the blue means low.

We see that with increasing sample sizes the 2-dimensional histogram estimates get smoother. By smoother we mean that the estimate get closer to representing the true distribution that the samples were drawn from. 

When we have only $N = 100$ samples the estimate looks quite sparse and one could not see that it's from a 2D gaussian distribution. But as we increase the sample size we can see the estimate take on a nicer form and the bins close to $\mu = (1,1)$ increase in density value as expected.
 
\subsection*{Question 1.8}

We implemented the transformation sampling method in \verb=sampling.py= to draw samples from the exponential distribution. In figure $9$ we can see how the sample mean $\hat{y}$ converges to the true mean $\mu_y$ of the exponential distribution.

\begin{figure}[H]
	\centering
  	\includegraphics[width=0.5\textwidth]{montecarlo.png}
  	\caption{Convergence plot for the sample mean from the exponential distribution}
\end{figure}

We have the sample size $L$ on the $x$-axis and the sample mean deviation from the true mean $|\mu_y - \hat{y}|$ on the $y$-axis. We tried for sample sizes $L = \{10,100,1.000,10.000\}$ and averaged the deviation over $1000$ repetitions for each $L$. As we see on the plot the deviation converges towards $0$ as $L$ increases.

Now we note that the deviation seems to converge exponentially. In figure $10$ we can se a log-plot of the deviation, which we see is linear confirming our suspicion of exponential convergence. We plot $\log(|\mu_y - \hat{y}|)$ on the $y$-axis in figure $10$.

\begin{figure}[H]
	\centering
  	\includegraphics[width=0.5\textwidth]{montecarlo_logplot.png}
  	\caption{Convergence logplot for the sample mean from the exponential distribution}
\end{figure}

\section{Real data - simple color-based object detection}

\subsection{1.8}

\newpage
\appendix

\section{Random data}

\begin{verbatim}
array([[ 0.72193061,  0.55650806],
       [ 0.71297482,  1.07638665],
       [ 0.0092223 ,  0.31207955],
       [ 1.26288325,  0.53376191],
       [ 0.37936011,  0.41056112],
       [ 0.45977093,  0.90105456],
       [ 1.21328513,  1.38968883],
       [ 1.79445033,  1.84837734],
       [ 1.92186304,  1.96301853],
       [ 0.15731425,  0.25997341],
       [ 0.62793672,  0.70533181],
       [ 0.99486393,  1.01006694],
       [ 1.8476812 ,  0.85853678],
       [ 0.14284534,  0.88913123],
       [ 0.97716776,  1.09018915],
       [ 0.97161201,  0.58900998],
       [ 1.73500472,  1.44673582],
       [ 0.9647784 ,  0.67339812],
       [-0.0737985 ,  0.29697366],
       [ 0.52818022,  0.17606585],
       [ 0.65179958,  0.52030596],
       [ 1.17995644,  0.97501462],
       [ 0.93388565,  1.11121914],
       [ 0.37516049,  0.47811406],
       [ 2.28856566,  1.92727012],
       [ 0.75213189,  0.60649678],
       [ 0.7318502 ,  1.03739217],
       [ 1.0689742 ,  1.78706917],
       [ 1.49248181,  1.68003937],
       [ 0.92929904,  0.76517611],
       [ 1.01305702,  0.87592965],
       [ 1.68066055,  1.74996003],
       [ 0.47905599,  0.8866    ],
       [ 1.34995982,  1.17785485],
       [ 0.14056147,  0.43742631],
       [ 1.14034598,  0.59048899],
       [ 0.81685558,  0.86283475],
       [ 0.77493163,  0.78814645],
       [ 0.78272775,  1.16437973],
       [-0.03891889,  0.39602963],
       [ 0.24695063,  0.68468749],
       [ 0.65705899,  1.19921722],
       [ 0.75625179,  0.51066502],
       [ 1.94282437,  2.00203365],
       [ 0.3120499 ,  0.73915184],
       [ 0.40481216,  0.47550674],
       [ 0.99378278,  1.40024804],
       [ 1.29908681,  1.40593826],
       [ 0.25305162,  0.00595536],
       [ 1.42712167,  1.18255341],
       [ 1.37167545,  1.50937496],
       [ 1.00078164,  1.08894058],
       [ 0.30535403,  0.49734938],
       [ 1.33500435,  0.96301662],
       [ 0.91019813,  0.81695105],
       [ 0.71188197,  1.17003723],
       [ 0.69000046,  1.04905076],
       [ 0.87673898,  0.42501247],
       [ 1.25174865,  0.93950734],
       [ 1.84500802,  1.21012506],
       [-0.11342139,  0.45389379],
       [ 0.50949098,  1.35315014],
       [ 1.66303637,  1.52663501],
       [ 1.25161124,  1.09516981],
       [ 1.03730311,  1.22388444],
       [ 1.3490821 ,  1.19041928],
       [-0.40000405,  0.21139045],
       [ 0.16126175,  0.24460852],
       [ 0.47175214,  0.4866838 ],
       [ 0.61041822,  0.39119264],
       [ 0.91784034,  1.15885657],
       [ 1.47795819,  1.29158918],
       [-0.14656642,  0.31257236],
       [ 1.3808889 ,  1.50453295],
       [ 1.37033896,  1.46412463],
       [-0.0744577 ,  0.63083995],
       [ 0.12192975,  0.47079   ],
       [ 1.74950922,  1.52973459],
       [ 1.41792453,  1.54522115],
       [ 0.07715062, -0.05034012],
       [ 1.83700728,  1.57702777],
       [ 0.94535332,  0.64067317],
       [ 1.58643266,  1.61009736],
       [ 0.8661403 ,  1.0710702 ],
       [ 1.20950009,  1.21510719],
       [-0.42484873,  0.12512812],
       [ 1.03568596,  0.68615155],
       [ 0.99644923,  1.05526292],
       [ 1.0486149 ,  0.90956878],
       [ 1.0250742 ,  0.81378442],
       [ 1.11217724,  1.29401667],
       [ 1.31009392,  1.38829251],
       [ 0.70994221,  0.98957382],
       [ 1.18102012,  1.26734074],
       [ 0.40896285,  0.27386058],
       [ 0.8875179 ,  0.71563476],
       [ 2.09703402,  2.06702828],
       [ 0.67191743,  0.80783912],
       [ 0.56457787,  0.44008001],
       [ 1.26197261,  0.61118427]])
\end{verbatim}

\begin{comment}
\begin{figure}[H]
	\centering
	\begin{subfigure}{0.45\textwidth}
  		\centering
  		\includegraphics[width=\textwidth]{../week4/images/prob41asurf.png}
  		\caption{$x=(0,-1)$}
  \end{subfigure}
  \begin{subfigure}{0.45\textwidth}
  		\centering
  		\includegraphics[width=\textwidth]{../week4/images/prob41bsurf.png}
  		\caption{$x=(0,0.05)$}
  \end{subfigure}
  	\caption{Surface plots of $m(p)$ at different points}
\end{figure}
\end{comment}


\end{document}




































